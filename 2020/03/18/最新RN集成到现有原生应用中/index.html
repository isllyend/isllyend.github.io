<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Chigggo"><link rel="alternative" href="/atom.xml" title="Chigo's Blog" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>最新RN集成到现有原生应用中 - Chigo's Blog</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0;"><header class="head"><h1 class="head-title u-fl"><a href="/">Chigo's Blog</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">カタログ/（目录）</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head">  <time class="post__time" datetime="2020-03-18T05:00:00.000Z">三月 18, 2020</time><h1 class="post__title"><a href="/2020/03/18/最新RN集成到现有原生应用中/">最新RN集成到现有原生应用中</a></h1><div class="post__main echo"><p><code>react-native:0.61.5</code></p>
<p><code>react:16.9.0</code></p>
<h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><ol>
<li>配置好RN依赖和项目结构</li>
<li>编写RN组件js代码</li>
<li>在Android中添加一个<code>RCTRootView</code>,用来承载RN组件的容器</li>
</ol>
<h2 id="主要步骤"><a href="#主要步骤" class="headerlink" title="主要步骤"></a>主要步骤</h2><ul>
<li><p>配置好RN环境和android 环境 <a href="https://reactnative.cn/docs/getting-started" target="_blank" rel="noopener">https://reactnative.cn/docs/getting-started</a></p>
</li>
<li><p>创建RN项目</p>
<ol>
<li>可手动配置相关依赖包来创建新项目</li>
<li>使用<code>react-native init ProjectName</code></li>
</ol>
</li>
<li><p>将现有的Android项目替换到/android中</p>
</li>
<li><p>配置Android代码</p>
<ol>
<li><p>配置maven </p>
<p>​    在app级别的<code>build.gradle</code>添加依赖:</p>
</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解决 rn 0.60 引进jsc和hermes报错 libjsc/libhermes.so找不到</span></span><br><span class="line">def jscFlavor = <span class="string">'org.webkit:android-jsc:+'</span></span><br><span class="line">project.ext.react = [</span><br><span class="line">        entryFile: <span class="string">"index.js"</span>,</span><br><span class="line">        enableHermes: <span class="literal">false</span>,  <span class="comment">// 开启需./gradlew clean 并重新编译</span></span><br><span class="line">]</span><br><span class="line">def enableHermes = project.ext.react.<span class="keyword">get</span>(<span class="string">"enableHermes"</span>, <span class="literal">false</span>)</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">dependencies&#123;</span><br><span class="line">  implementation <span class="string">'androidx.appcompat:appcompat:1.1.0'</span></span><br><span class="line">	implementation <span class="string">'androidx.core:core-ktx:1.0.2'</span></span><br><span class="line"></span><br><span class="line">	implementation <span class="string">"com.facebook.react:react-native:+"</span></span><br><span class="line"><span class="comment">//implementation 'androidx.swiperefreshlayout:swiperefreshlayout:1.1.0-beta01'//报错缺少该库再添加</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​            在项目级别的 <code>build.gradle</code> 文件中为 React Native 添加一个 maven 依赖的入口，必须写在 “allprojects” 代码块中:     </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">      	.....</span><br><span class="line">        maven &#123;</span><br><span class="line">            <span class="comment">// All of React Native (JS, Android binaries) is installed from npm</span></span><br><span class="line">            url <span class="string">"<span class="variable">$rootDir</span>/../node_modules/react-native/android"</span></span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">          	<span class="comment">//解决 rn 0.60 引进jsc和hermes报错 libjsc/libhermes.so找不到</span></span><br><span class="line">            <span class="comment">// Android JSC is installed from npm</span></span><br><span class="line">            url(<span class="string">"<span class="variable">$rootDir</span>/../node_modules/jsc-android/dist"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><p>配置权限</p>
<p>​    在 <code>AndroidManifest.xml</code> 清单文件中声明网络权限:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>​    如果需要访问 <code>DevSettingsActivity</code> 界面（即开发者菜单），则还需要在 <code>AndroidManifest.xml</code> 中声明:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;activity android:name=&quot;com.facebook.react.devsupport.DevSettingsActivity&quot; /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置Network Security Config</p>
<blockquote>
<p>从Android 9（API级别28）开始，默认情况下，明文流量被禁用； 这可以防止您的应用程序连接到React Native打包器。 这些更改添加了域规则，这些规则专门允许明文流量流向打包程序IP。</p>
</blockquote>
</li>
</ol>
</li>
</ul>
<pre><code><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;application</span><br><span class="line">			...</span><br><span class="line">      android:networkSecurityConfig=<span class="string">"@xml/network_security_config"</span></span><br></pre></td></tr></table></figure>


<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">network-security-config</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- allow cleartext traffic for React Native packager ips in debug --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">domain-config</span> <span class="attr">cleartextTrafficPermitted</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- deny cleartext traffic for React Native packager ips in release --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">domain-config</span> <span class="attr">cleartextTrafficPermitted</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">domain</span> <span class="attr">includeSubdomains</span>=<span class="string">"false"</span>&gt;</span>localhost<span class="tag">&lt;/<span class="name">domain</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">domain</span> <span class="attr">includeSubdomains</span>=<span class="string">"false"</span>&gt;</span>10.0.2.2<span class="tag">&lt;/<span class="name">domain</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">domain</span> <span class="attr">includeSubdomains</span>=<span class="string">"false"</span>&gt;</span>10.0.3.2<span class="tag">&lt;/<span class="name">domain</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">domain-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">network-security-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</code></pre><ol>
<li><p><em>核心</em>:使用<code>ReactRootView</code>作为容器,并在<code>AndroidManifest.xml</code>中注册(也可使用ReactActivity来作为RN容器,相对不灵活 可定制差)</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyReactActivity</span> : <span class="type">AppCompatActivity</span></span>(), DefaultHardwareBackBtnHandler &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> OVERLAY_PERMISSION_REQ_CODE = <span class="number">1</span>; </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> mReactRootView: ReactRootView;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> mReactInstanceManager: ReactInstanceManager;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">      	...</span><br><span class="line">        mReactRootView = ReactRootView(<span class="keyword">this</span>);</span><br><span class="line">        mReactInstanceManager = ReactInstanceManager.builder()</span><br><span class="line">            .setApplication(application)</span><br><span class="line">            .setCurrentActivity(<span class="keyword">this</span>)</span><br><span class="line">            .setBundleAssetName(<span class="string">"index.android.bundle"</span>)</span><br><span class="line">            .setJSMainModulePath(<span class="string">"index"</span>)</span><br><span class="line">            .addPackage(MainReactPackage())</span><br><span class="line">            .setUseDeveloperSupport(BuildConfig.DEBUG)</span><br><span class="line">            .setInitialLifecycleState(LifecycleState.RESUMED)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">      	<span class="comment">//App1 与AppRegistry.registerComponent('App1', () =&gt; App)中相对应不能有错</span></span><br><span class="line">        mReactRootView.startReactApplication(mReactInstanceManager, <span class="string">"App1"</span>, <span class="literal">null</span>)</span><br><span class="line">        setContentView(mReactRootView)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">invokeDefaultOnBackPressed</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onBackPressed()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>配置权限以便开发中的红屏错误能正确显示

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    	....</span><br><span class="line">			<span class="keyword">if</span> (!Settings.canDrawOverlays(<span class="keyword">this</span>)) &#123;</span><br><span class="line">            <span class="keyword">val</span> REQUEST_CODE = <span class="number">101</span>;</span><br><span class="line">            <span class="keyword">val</span> myIntent = Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION);</span><br><span class="line">            myIntent.<span class="keyword">data</span> = Uri.parse(<span class="string">"package:<span class="variable">$packageName</span>"</span>);</span><br><span class="line">            startActivityForResult(myIntent, REQUEST_CODE);</span><br><span class="line">		 &#125;</span><br><span class="line">&#125;	</span><br><span class="line">    <span class="meta">@SuppressLint(<span class="meta-string">"MissingSuperCall"</span>)</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityResult</span><span class="params">(requestCode: <span class="type">Int</span>, resultCode: <span class="type">Int</span>, <span class="keyword">data</span>: <span class="type">Intent</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (requestCode == OVERLAY_PERMISSION_REQ_CODE) &#123;</span><br><span class="line">            <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!Settings.canDrawOverlays(<span class="keyword">this</span>)) &#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mReactInstanceManager.onActivityResult(<span class="keyword">this</span>, requestCode, resultCode, <span class="keyword">data</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


生命周期回调传递给`ReactInstanceManager`:

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">     </span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onPause</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onPause()</span><br><span class="line">    <span class="keyword">if</span> (mReactInstanceManager != <span class="literal">null</span>) &#123;</span><br><span class="line">        mReactInstanceManager.onHostPause(</span><br><span class="line">            <span class="keyword">this</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">     </span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onResume</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onResume()</span><br><span class="line">    mReactInstanceManager.onHostResume(<span class="keyword">this</span>, <span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line">     </span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroy</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onDestroy()</span><br><span class="line">    <span class="keyword">if</span> (mReactInstanceManager != <span class="literal">null</span>) &#123;</span><br><span class="line">        mReactInstanceManager.onHostDestroy(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mReactRootView != <span class="literal">null</span>) &#123;</span><br><span class="line">        mReactRootView.unmountReactApplication();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


后退按钮事件传递给 React Native:

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBackPressed</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mReactInstanceManager != <span class="literal">null</span>) &#123;</span><br><span class="line">            mReactInstanceManager.onBackPressed();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">super</span>.onBackPressed();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


添加自定义Application SoLoader初始化

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> : <span class="type">Application</span></span>() &#123;</span><br><span class="line">       <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">()</span></span> &#123;</span><br><span class="line">           <span class="keyword">super</span>.onCreate()</span><br><span class="line">           SoLoader.init(<span class="keyword">this</span>, <span class="literal">false</span>)</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:name</span>=<span class="string">".MyApp"</span></span></span><br><span class="line"><span class="tag"> <span class="attr">....</span></span></span><br></pre></td></tr></table></figure>


原生Android中跳转:

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">btn.setOnClickListener &#123;</span><br><span class="line">              startActivity(Intent(<span class="keyword">this</span>,MyReactActivity::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>))</span></span><br><span class="line">          &#125;</span><br></pre></td></tr></table></figure>
</code></pre><ul>
<li><p>编写JS代码</p>
<p><code>index.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app1切记与Android中.startReactApplication(mReactInstanceManager, "App1", null)对应</span></span><br><span class="line">AppRegistry.registerComponent(<span class="string">'App1'</span>, () =&gt; App);</span><br></pre></td></tr></table></figure>
<p><code>App.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> App: <span class="function"><span class="params">()</span> =&gt;</span> React$Node = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">          &lt;Text style=&#123;styles.hello&#125;&gt;Hello, World&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>View&gt;</span><br><span class="line">      &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;;</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">    container: &#123;</span></span><br><span class="line"><span class="regexp">      flex: 1,</span></span><br><span class="line"><span class="regexp">      justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    hello: &#123;</span></span><br><span class="line"><span class="regexp">      fontSize: 20,</span></span><br><span class="line"><span class="regexp">      textAlign: 'center',</span></span><br><span class="line"><span class="regexp">      margin: 10,</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">  &#125;);</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  export default App;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>##在Android Studio 中打包</p>
<p>  步骤基本和原生应用一样，只是在每次编译打包之前需要先执行 js 文件的打包(即生成离线的 jsbundle 文件)。具体的 js 打包命令如下：</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> react-native bundle --platform android --dev <span class="literal">false</span> --entry-file index.js --bundle-output android/com/your-company-name/app-package-name/src/main/assets/index.android.bundle --assets-dest android/com/your-company-name/app-package-name/src/main/res/</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>路径为实际项目的路径。如果 assets 目录不存在，则需要提前创建,而后正常打包即可.</p>
</blockquote>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/react-native/">react-native</a></li></ul></footer></article><section class="reward"> <a class="btn-reward" href="#">打赏</a><div class="reward-wrapper clearfix"><img src="/img/wechat.png" title="微信"></div></section><div class="comments" id="lv-container" data-id="isllyend" data-uid="MTAyMC8yOTI4Ny81ODU1"><script>(function(d, s) {var j, e = d.getElementsByTagName(s)[0];if (typeof LivereTower === 'function') { return; } j = d.createElement(s);j.src = 'https://cdn-city.livere.com/js/embed.dist.js';j.async = true;e.parentNode.insertBefore(j, e);})(document, 'script');</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2017-2020 Chigggo</div></footer><canvas class="live2d" id="live2dcanvas" width="400" height="800"></canvas>
    <script type="text/javascript" src="/live2d/script.js"></script>
    <canvas id="live2dcanvas" width="150" height="300" class="live2d"></canvas>
    <style>
      #live2dcanvas {
        position: fixed;
        right: 0px;
        z-index: 999;
        pointer-events: none;
        bottom: 80px;
      }
    </style>
    <script>loadlive2d("live2dcanvas" ,"/live2d/assets/haru/haru.model.json")</script>
  <script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>